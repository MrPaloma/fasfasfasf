{% extends 'base_nfr.html' %}
{% load static %}

{% block css %}
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
{% endblock %}

{% block content %}

<div class="container">
  <section class="accordion-section clearfix mt-3" aria-label="Question Accordions">
    
    <h2>
      Preguntas Frecuentes  
    </h2>

    <form class="form-group" method="GET" id="buscar_pregunta">
    <div class="row">
        {% csrf_token %}
        <div class="col-3">
          <select name="tipo_uso" class="language form-control" id="id_tipo_uso">
            {% for tu in tipo_uso %}
            <option value="{{tu.id}}">{{tu.area_name}}</option>
          {% endfor %}
          </select>
        </div>
        <div class="col-3">
          <input class="form-control" type="text" name="datetimes" id="datetimes"/>
        </div>
        <div class="col-5">
            <input type="text" name="title__icontains" class="form-control" placeholder="BUSCAR POR TITULO DE PREGUNTA" id="id_title__icontains">
        </div>
        <div class="col-1 form-group" style="padding-left: 0.2px;">
          <button class="btn btn-warning btn-lg search_btn search_btn filter-btn" type="submit"> 
            <i class="fas fa-search"></i>  
          </button>
        </div>
      </div>
    </form>
    
    {% if perms.normas.add_policies_usage %}
      <a href="{% url 'admin:normas_policies_usage_changelist' %}" class="btn btn-square btn-primary mb-3" ><i class="fas fa-plus"></i> Agregar pregunta</a> 
    {% endif %}


    
    <div class="accordion mt-3" id="accordionExample">
      {% for p in preguntas %}
      <div class="card mb-2">
        <div class="card-header bg-info" id="headingOne">
          <h2 class="mb-0">
            <button class="btn  btn-block text-left" type="button" data-toggle="collapse" data-target="#collapse{{p.id}}" aria-expanded="true" aria-controls="collapse{{p.id}}">
              <b class="text-white">
                {{p.title}}
              </b>
            </button>
          </h2>
        </div>
    
        <div id="collapse{{p.id}}" class="collapse show" aria-labelledby="headingOne" data-parent="#accordionExample">
          <div class="card-body">
            {{p.message}}
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    
  </section>
</div>

{% endblock content %}

{% block js %}
<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>

<script>
  $(document).ready(function() {
    $('#datetimes').daterangepicker({
      locale: {
          format: 'YYYY-MM-DD'
      }
    });
    $("#buscar_pregunta").submit( function(e) {
      e.preventDefault();
      $.ajax({
        url: $(this).attr('action'),
        type: $(this).attr('method'),
        data: $(this).serialize()
      }).done(function(data) {
        
      });
    });
  })
</script>

{% endblock %}
