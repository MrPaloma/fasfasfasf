{% extends 'base_nfr.html' %}
{% load static %}


{% block content %}
<div class="container">
    <h1 class="text-center">Registro de Normativas</h1>
    <br>
    <div class="row">
        <div class="col">
            <a href="{% url 'crear-normativa' %}" class="btn btn-primary text-white" style="background-color:#24387C;">
                <i class="fas fa-plus"></i>
                Agregar nueva
            </a>
        </div>
    </div>
    <br>
    <table class="table table-bordered">
        <thead>
            <tr>
                <td>Norma</td>
                <td>Titulo</td>
                <td>Base Legal</td>
                <td>Tipo Uso</td>
                <td>Documento</td>
                <td>Publicacion</td>
                <td>Observacion</td>
                {% comment %} <td>Palabra clave</td> {% endcomment %}
            </tr>
        </thead>
        <tbody>
            {% if entity %}
                {% for norma in entity %}
                <tr>
                    <td>{{norma.norma}}
                        <br>
                        {% if norma.es_vigente == False %}
                            <span class="fst-italic fw-lighter fs-7 text-danger">*No vigente</span>
                        {% endif %}
                    </td>
                    <td>{{norma.name_denom}} 
                        
                    </td>
                    <td>{{norma.base_legal}}</td>
                    <td>{{norma.tipo_uso}}</td>
                    <td class="text-center">
                        {% if norma.document %}
                            <a target="_blank" href="{{norma.document.url}}">
                                <i class="fa fa-file-pdf fa-2x text-danger mr-1" aria-hidden="true"></i>
                            </a>
                        {% else %}

                        <span class="text-center"><i class="fa fa-minus fa-2x text-dark" aria-hidden="true"></i></span>
                        {% endif %}
                    </td>
                    <td>{{norma.fecha_publi}}</td>
                    <td>
                        <a href="{% url 'editar-normativa' norma.id %}" class="btn btn-warning">
                            <i class="fas fa-edit" ></i>
                        </a>
                    
                        <a onclick="ConfirmDelete({{norma.id}})" href="#" class="btn btn-danger">
                            <i class="fas fa-trash"></i>
                        </a>
                    </td>
                    {% comment %} <td class="text-center">
                        <a href="/register_clave/{{norma.id}}" class="btn btn-success">
                            <i class="fa fa-plus" aria-hidden="true"></i>
                        </a>
                    </td> {% endcomment %}
                </tr>
                {% endfor %}
            {% endif %}
        </tbody>
    </table>  

    {% include '../partials/_paginator.html' %}
</div>
{% endblock %}

{% block js %}
    <script>
        function ConfirmDelete(id){
            Swal.fire({
            title: 'Esta seguro que desea eliminar?',
            text: "Esta accion es irreversible!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Si, eliminar!'
            }).then((result) => {
                if (result.isConfirmed) {
                    window.location.href = `normativas/${id}/eliminar`
                }
            })
        }
    </script>
{% endblock %}